# 石头剪刀布识别系统

## 项目简介
本项目实现了一个基于 BP 神经网络的石头剪刀布图像分类系统。通过训练神经网络，系统能够识别图片中的手势（石头、剪刀、布）。

## 文件结构
- **BP.py**: 实现 BP 神经网络的核心逻辑，包括前向传播、反向传播、训练和预测。
- **photo.py**: 提供图像预处理和数据集加载功能。
- **BP_new.py**: 包含完整的系统逻辑，包括数据加载、模型训练、评估和测试。
- **数据文件夹**:
  - `shitou/`: 存放石头类别的图片。
  - `jiandao/`: 存放剪刀类别的图片。
  - `bu/`: 存放布类别的图片。

## 主要功能
1. **BP 神经网络**:
   - 使用 Xavier 初始化权重。
   - 支持多分类任务，输出层使用 Softmax 激活函数。
   - 通过交叉熵损失函数优化模型。

2. **图像预处理**:
   - 将图片转换为灰度图。
   - 调整图片大小为 64x64。
   - 归一化到 [0, 1] 范围。
   - 展平为一维向量。

3. **数据集加载**:
   - 自动加载 `shitou`、`jiandao` 和 `bu` 文件夹中的图片。
   - 将标签转换为独热编码。

4. **模型训练与评估**:
   - 支持训练集和测试集划分。
   - 输出训练过程中的损失和准确率。
   - 提供测试单张图片的功能。

## 使用方法
1. **准备数据集**:
   - 在项目根目录下创建 `shitou`、`jiandao` 和 `bu` 文件夹。
   - 将对应类别的图片放入相应文件夹。

2. **运行项目**:
   - 执行 `BP_new.py` 文件。
   - 系统会自动加载数据集、训练模型并评估性能。

3. **测试图片**:
   - 在 `BP_new.py` 中指定测试图片路径。
   - 系统会输出预测结果和各类别的概率。

## 示例输出
```
=== 石头剪刀布BP神经网络识别系统 ===

1. 加载数据集...
数据集大小: 300 张图片
图片特征维度: 4096

2. 划分训练集和测试集...
训练集大小: 240
测试集大小: 60

3. 创建BP神经网络...

4. 开始训练...
Epoch 0/500, Loss: 1.0986, Accuracy: 0.3333
Epoch 100/500, Loss: 0.8642, Accuracy: 0.7500
...
训练完成！

5. 评估模型性能...
训练集准确率: 0.9500
测试集准确率: 0.9000

6. 测试具体图片...
图片: ./shitou/shitou1.jpg
预测结果: 石头
各类别概率:
  石头: 0.9500
  剪刀: 0.0300
  布: 0.0200
```

## 环境依赖
- Python 3.10
- NumPy
- OpenCV

## 注意事项
- 确保图片文件夹命名正确。
- 图片格式支持 `.jpg`、`.jpeg`、`.png` 和 `.bmp`。
- 如果图片无法加载或处理，请检查路径和格式。

## 联系方式
如有问题，请联系开发者。
